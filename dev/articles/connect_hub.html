<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Accessing data from a hub • hubData</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Accessing data from a hub">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://hubdocs.readthedocs.io/en/latest/" class="external-link"><img src="https://raw.githubusercontent.com/hubverse-org/hubStyle/main/inst/hubverse.png" id="logo" height="30" alt="hubverse"></a>
    <a class="navbar-brand me-2" href="../index.html">hubData</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/connect_hub.html">Accessing data from a hub</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hubverse-org/hubData/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Accessing data from a hub</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hubverse-org/hubData/blob/main/vignettes/articles/connect_hub.Rmd" class="external-link"><code>vignettes/articles/connect_hub.Rmd</code></a></small>
      <div class="d-none name"><code>connect_hub.Rmd</code></div>
    </div>

    
    
<p>An important function of <code>hubData</code> is allowing for the
connection to data in the <code>model-output</code> directory to
facilitate extraction, filtering, querying, exploring, and analyzing of
Hub data.</p>
<div class="section level2">
<h2 id="structure-of-hubverse-datasets">Structure of hubverse datasets<a class="anchor" aria-label="anchor" href="#structure-of-hubverse-datasets"></a>
</h2>
<p>All data returned from connecting to and querying hubs can be read or
validated as a <code>model_out_tbl</code> which is a foundational S3
class in the hubverse ecosystem. A <code>model_out_tbl</code> is a
long-form <a href="https://tibble.tidyverse.org/" class="external-link"><code>tibble</code></a> designed to
conform to the <a href="https://hubverse.io/en/latest/user-guide/model-output.html" class="external-link">hubverse
data specifications for model output data</a>. In short, the columns of
a valid <code>model_out_tbl</code> containing model output data from a
hub are:</p>
<ul>
<li>
<code>model_id</code>: this is the unique character identifier of a
model.</li>
<li>
<code>output_type</code>: a character variable that defines the type
of representation of model output that is in a given row.</li>
<li>
<code>output_type_id</code>: a variable that specifies some
additional identifying information specific to the output type in a
given row, e.g., a numeric quantile level, a string giving the name of a
possible category for a discrete outcome, or an index of a sample.</li>
<li>
<code>value</code>: a numeric variable that provides the information
about the model’s prediction.</li>
<li>
<code>...</code> : other columns will be present depending on
modeling tasks defined by the individual modeling hub. These columns are
referred to in hubverse terminology as the <code>task-ID</code>
variables.</li>
</ul>
<p>Other hubverse tools, designed for data validation, <a href="https://hubverse-org.github.io/hubEnsembles/" class="external-link">ensemble
building</a>, <a href="https://github.com/hubverse-org/hubVis" class="external-link">visualization</a>, etc…,
all are designed with the “promises” implicit in the data format
specified by <code>model_out_tbl</code>. For example, <a href="https://hubverse-org.github.io/hubEnsembles/reference/linear_pool.html" class="external-link">the
<code>hubEnsembles::linear_pool()</code> function</a> both accepts as
input and returns as output <code>model_out_tbl</code> objects.</p>
</div>
<div class="section level2">
<h2 id="hub-connections">Hub connections<a class="anchor" aria-label="anchor" href="#hub-connections"></a>
</h2>
<p>There are two functions for connecting to <code>model-output</code>
data:</p>
<ul>
<li>
<code><a href="../reference/connect_hub.html">connect_hub()</a></code> is used for connecting to fully
configured hubs (i.e. which contain valid <code>admin.json</code> and
<code>tasks.json</code> in a <code>hub-config</code> directory). This
function uses configurations defined in config files in the
<code>hub-config/</code> directory and allows for connecting to hubs
with files in multiple file formats (allowable formats specified by the
<code>file_format</code> property of <code>admin.json</code>).</li>
<li>
<code><a href="../reference/connect_hub.html">connect_model_output()</a></code> allows for connecting directly
to the contents of a <code>model-output</code> directory and is useful
for connecting to appropriately organised files in an informal hub
(i.e. which has not been fully configured with appropriate
<code>hub-config/</code> files.)</li>
</ul>
<p>Both functions establish connections through the <a href="https://arrow.apache.org/docs/r/" class="external-link"><code>arrow</code></a> package,
specifically by opening datasets as <a href="https://arrow.apache.org/docs/r/reference/Dataset.html" class="external-link"><code>FileSystemDataset</code>s</a>,
one for each file format. Both functions are also able to connect to
files that are stored locally or in the cloud (e.g. in AWS S3
buckets).</p>
<p>Where multiple file formats are accepted in a single Hub, file format
specific <code>FileSystemDataset</code>s are combined into a single
<code>UnionDataset</code> for single point access to the entire Hub
<code>model-output</code> dataset. This only applies to
<code><a href="../reference/connect_hub.html">connect_hub()</a></code> in fully configured Hubs, where config files
can be used to determine a unifying schema across all file formats.</p>
<p>In contrast, <code><a href="../reference/connect_hub.html">connect_model_output()</a></code> can only be used to
open single file format datasets of the format defined explicitly
through the <code>file_format</code> argument.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hubverse-org/hubData" class="external-link">hubData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="connecting-to-a-configured-hub">Connecting to a configured hub<a class="anchor" aria-label="anchor" href="#connecting-to-a-configured-hub"></a>
</h2>
<div class="section level3">
<h3 id="connecting-to-a-local-hub">Connecting to a local hub<a class="anchor" aria-label="anchor" href="#connecting-to-a-local-hub"></a>
</h3>
<p>To connect to a local hub, supply the path to the hub to
<code><a href="../reference/connect_hub.html">connect_hub()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testhubs/flusight"</span>, package <span class="op">=</span> <span class="st">"hubUtils"</span><span class="op">)</span></span>
<span><span class="va">hub_con</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_hub</a></span><span class="op">(</span><span class="va">hub_path</span><span class="op">)</span></span>
<span><span class="va">hub_con</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;hub_connection/UnionDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_name: <span style="color: #0000BB;">"US CDC FluSight"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_path: <span style="color: #0000BB;">/home/runner/work/_temp/Library/hubUtils/testhubs/flusight</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"csv(5/5)"</span>, <span style="color: #0000BB;">"parquet(2/2)"</span>, and <span style="color: #0000BB;">"arrow(1/1)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">TRUE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"LocalFileSystem"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">"/home/runner/work/_temp/Library/hubUtils/testhubs/flusight/forecasts"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_admin: <span style="color: #0000BB;">hub-config/admin.json</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_tasks: <span style="color: #0000BB;">hub-config/tasks.json</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; hub_connection</span></span>
<span><span class="co">#&gt; 8 columns</span></span>
<span><span class="co">#&gt; forecast_date: date32[day]</span></span>
<span><span class="co">#&gt; horizon: int32</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: string</span></span>
<span><span class="co">#&gt; value: double</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="connecting-to-a-hub-in-the-cloud">Connecting to a hub in the cloud<a class="anchor" aria-label="anchor" href="#connecting-to-a-hub-in-the-cloud"></a>
</h3>
<p>To connect to a hub in the cloud, first use one of the re-exported
<code>arrow</code> helpers <code><a href="../reference/s3_bucket.html">s3_bucket()</a></code> or
<code><a href="../reference/gs_bucket.html">gs_bucket()</a></code> depending on the cloud storage provider, and a
string of the bucket name/path to create the appropriate cloud
<code>*FileSystem</code> object (For more details consult the
<code>arrow</code> article on <a href="https://arrow.apache.org/docs/r/articles/fs.html" class="external-link">Using cloud
storage (S3, GCS)</a>).</p>
<p>Then supply the resulting <code>*FileSystem</code> object to
<code><a href="../reference/connect_hub.html">connect_hub()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_path_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/s3_bucket.html">s3_bucket</a></span><span class="op">(</span><span class="st">"hubverse/hubutils/testhubs/simple/"</span><span class="op">)</span></span>
<span><span class="va">hub_con_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_hub</a></span><span class="op">(</span><span class="va">hub_path_cloud</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Updating superseded URL `Infectious-Disease-Modeling-hubs` to `hubverse-org`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Updating superseded URL `Infectious-Disease-Modeling-hubs` to `hubverse-org`</span></span>
<span><span class="va">hub_con_cloud</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;hub_connection/UnionDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_name: <span style="color: #0000BB;">"Simple Forecast Hub"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_path: <span style="color: #0000BB;">hubverse/hubutils/testhubs/simple/</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"csv(3/3)"</span> and <span style="color: #0000BB;">"parquet(1/1)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">TRUE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"S3FileSystem"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir: <span style="color: #0000BB;">"model-output/"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_admin: <span style="color: #0000BB;">hub-config/admin.json</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_tasks: <span style="color: #0000BB;">hub-config/tasks.json</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; hub_connection</span></span>
<span><span class="co">#&gt; 9 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int32</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: double</span></span>
<span><span class="co">#&gt; value: int32</span></span>
<span><span class="co">#&gt; model_id: string</span></span>
<span><span class="co">#&gt; age_group: string</span></span></code></pre></div>
<div class="section level4">
<h4 id="performance-considerations">Performance considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a>
</h4>
<p>By default, <code><a href="../reference/connect_hub.html">connect_hub()</a></code> will ignore invalid files in
the hub’s model output directory when it creates a connection. This
check prevents errors when working with the data, but it negatively
impacts performance.</p>
<p>If the cloud-based hub uses a single file type for model output data,
you can improve performance by using the <code>skip_checks</code>
argument. This argument will bypass the default behavior of scanning the
hub’s model output directory for invalid files before connecting.</p>
<p>Using this argument will fail unless the hub meets the following
criteria:</p>
<ul>
<li>the model output directory contains only model output data (no
<code>README.md</code>, for example)</li>
<li>the model output files use a single file format.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_path_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/s3_bucket.html">s3_bucket</a></span><span class="op">(</span><span class="st">"hubverse/hubutils/testhubs/parquet/"</span><span class="op">)</span></span>
<span><span class="va">hub_con_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_hub</a></span><span class="op">(</span><span class="va">hub_path_cloud</span>, file_format <span class="op">=</span> <span class="st">"parquet"</span>, skip_checks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Updating superseded URL `Infectious-Disease-Modeling-hubs` to `hubverse-org`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Updating superseded URL `Infectious-Disease-Modeling-hubs` to `hubverse-org`</span></span>
<span><span class="va">hub_con_cloud</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;hub_connection/FileSystemDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_name: <span style="color: #0000BB;">"Simple Forecast Hub"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> hub_path: <span style="color: #0000BB;">hubverse/hubutils/testhubs/parquet/</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"parquet(4/4)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">FALSE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"S3FileSystem"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir: <span style="color: #0000BB;">"model-output/"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_admin: <span style="color: #0000BB;">hub-config/admin.json</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> config_tasks: <span style="color: #0000BB;">hub-config/tasks.json</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; hub_connection with 4 Parquet files</span></span>
<span><span class="co">#&gt; 9 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int32</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; age_group: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: double</span></span>
<span><span class="co">#&gt; value: int32</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="accessing-data">Accessing data<a class="anchor" aria-label="anchor" href="#accessing-data"></a>
</h2>
<p>To access data from a hub connection you can use dplyr verbs and
construct querying pipelines.</p>
<p>To perform the queries, you can use <code>dplyr</code>’s
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 276 × 8</span></span></span>
<span><span class="co">#&gt;    forecast_date horizon target        location output_type output_type_id value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2023-04-24          1 wk ahead inc… US       quantile    0.01               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2023-04-24          1 wk ahead inc… US       quantile    0.025              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2023-04-24          1 wk ahead inc… US       quantile    0.05               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2023-04-24          1 wk ahead inc… US       quantile    0.1              281</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2023-04-24          1 wk ahead inc… US       quantile    0.15             600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2023-04-24          1 wk ahead inc… US       quantile    0.2              717</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2023-04-24          1 wk ahead inc… US       quantile    0.25             817</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2023-04-24          1 wk ahead inc… US       quantile    0.3              877</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2023-04-24          1 wk ahead inc… US       quantile    0.35             913</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2023-04-24          1 wk ahead inc… US       quantile    0.4              965</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 266 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: model_id &lt;chr&gt;</span></span></span></code></pre></div>
<p>Note however that in the above example, while the output contains the
required <code>model_id</code>, <code>output_type</code>,
<code>output_type_id</code> and <code>value</code> columns for a
<code>model_out_tbl</code> object, it is returned as a
<code>tbl_df</code> or <code>tibble</code> object and the order of the
columns is not standardised.</p>
<div class="section level3">
<h3 id="use-collect_hub-to-return-model_out_tbls">Use <code>collect_hub()</code> to return
<code>model_out_tbl</code>s<a class="anchor" aria-label="anchor" href="#use-collect_hub-to-return-model_out_tbls"></a>
</h3>
<p>Conveniently, you can use the <code>hubData</code> wrapper
<code><a href="../reference/collect_hub.html">collect_hub()</a></code> which converts the output of
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code> to a <code>model_out_tbl</code> class
object where possible:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 276 × 8</span></span></span>
<span><span class="co">#&gt;    model_id     forecast_date horizon target location output_type output_type_id</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.01          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.025         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.05          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.1           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.15          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.2           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.25          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.3           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.35          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hub-baseline 2023-04-24          1 wk ah… US       quantile    0.4           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 266 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: value &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model_out_tbl" "tbl_df"        "tbl"           "data.frame"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="accessing-data-from-cloud-hubs">Accessing data from cloud hubs<a class="anchor" aria-label="anchor" href="#accessing-data-from-cloud-hubs"></a>
</h3>
<p>Accessing data from hubs in the cloud is exactly the same:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_con_cloud</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 230 × 9</span></span></span>
<span><span class="co">#&gt;    model_id        origin_date target     horizon location age_group output_type</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> team1-goodmodel 2022-10-08  wk inc fl…       1 US       <span style="color: #BB0000;">NA</span>        quantile   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 220 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: output_type_id &lt;dbl&gt;, value &lt;int&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="limitations-of-dplyr-queries-on-arrow-datasets">Limitations of <code>dplyr</code> queries on <code>arrow</code>
datasets<a class="anchor" aria-label="anchor" href="#limitations-of-dplyr-queries-on-arrow-datasets"></a>
</h3>
<p>Note that <a href="https://arrow.apache.org/docs/dev/r/reference/acero.html" class="external-link">not all
<code>dplyr</code> filtering options are available</a> on arrow
datasets.</p>
<p>For example, if you wanted to get all quantile predictions for the
last forecast date in the hub, you might try:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span>,</span>
<span>    <span class="va">forecast_date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">forecast_date</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `forecast_date == max(forecast_date, na.rm = TRUE)`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Expression not supported in filter() in Arrow</span></span>
<span><span class="co">#&gt; → Call collect() first to pull data into R.</span></span></code></pre></div>
<p>This doesn’t work however as <code>arrow</code> does not have an
equivalent <code>max</code> method for <code>Date[32]</code> data
types.</p>
<p>In such a situation, you could collect after applying the first
filtering level which does work for arrow and then finish the filtering
on the in-memory data returned by collect.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">forecast_date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">forecast_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 92 × 8</span></span></span>
<span><span class="co">#&gt;    model_id     forecast_date horizon target location output_type output_type_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.01          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.025         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.05          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.1           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.15          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.2           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.25          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.3           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.35          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.4           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 82 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: value &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Alternatively, depending on the size of the data, in might be quicker
to filter the data in two steps:</p>
<ol style="list-style-type: decimal">
<li>get the last forecast date available for the filtered subset.</li>
<li>use the last forecast date in the filtering query.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">last_forecast</span> <span class="op">&lt;-</span> <span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">forecast_date</span>, as_vector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span>,</span>
<span>    <span class="va">forecast_date</span> <span class="op">==</span> <span class="va">last_forecast</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 92 × 8</span></span></span>
<span><span class="co">#&gt;    model_id     forecast_date horizon target location output_type output_type_id</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.01          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.025         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.05          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.1           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.15          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.2           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.25          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.3           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.35          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.4           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 82 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: value &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="use-arrowto_duckdb-to-extend-available-queries">Use <code>arrow::to_duckdb()</code> to extend available queries<a class="anchor" aria-label="anchor" href="#use-arrowto_duckdb-to-extend-available-queries"></a>
</h4>
<p>You could alternatively use <code><a href="https://arrow.apache.org/docs/r/reference/to_duckdb.html" class="external-link">arrow::to_duckdb()</a></code> to first
convert the dataset connection to an in memory virtual DuckDB table.
This will allows you to run queries that are supported by DuckDB but not
by arrow, extending the potential queries that can be run against hub
data before collecting.</p>
<p><em>For more details see <a href="https://duckdb.org/2021/12/03/duck-arrow.html" class="external-link">DuckDB quacks
Arrow: A zero-copy data integration between Apache Arrow and
DuckDB</a>.</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/to_duckdb.html" class="external-link">to_duckdb</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span>,</span>
<span>    <span class="va">forecast_date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">forecast_date</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 92 × 8</span></span></span>
<span><span class="co">#&gt;    model_id     forecast_date horizon target location output_type output_type_id</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.01          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.025         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.05          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.1           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.15          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.2           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.25          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.3           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.35          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hub-baseline 2023-05-08          1 wk ah… US       quantile    0.4           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 82 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: value &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="connecting-to-a-model-output-directory">Connecting to a model output directory<a class="anchor" aria-label="anchor" href="#connecting-to-a-model-output-directory"></a>
</h2>
<p>There is also an option to connect directly to a model output
directory without using any metadata in a hub config file. This can be
useful when a hub has not been fully configured yet.</p>
<p>The approach does have certain limitations though. For example, an
overall unifying schema cannot be determined from the config files so
the ability of <code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset()</a></code> to connect and parse data
correctly cannot be guaranteed across files.</p>
<p>In addition, only a single file_format dataset can be opened.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_output_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testhubs/simple/model-output"</span>, package <span class="op">=</span> <span class="st">"hubUtils"</span><span class="op">)</span></span>
<span><span class="va">mod_out_con</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_model_output</a></span><span class="op">(</span><span class="va">model_output_dir</span>, file_format <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">mod_out_con</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;mod_out_connection/FileSystemDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"csv(3/3)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">TRUE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"LocalFileSystem"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">"/home/runner/work/_temp/Library/hubUtils/testhubs/simple/model-output"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; mod_out_connection with 3 csv files</span></span>
<span><span class="co">#&gt; 8 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int64</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: double</span></span>
<span><span class="co">#&gt; value: int64</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
<p>Accessing data follows the same procedure described for fully
configured hubs:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_out_con</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">output_type</span> <span class="op">==</span> <span class="st">"quantile"</span>, <span class="va">location</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/collect_hub.html">collect_hub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 138 × 8</span></span></span>
<span><span class="co">#&gt;    model_id origin_date target horizon location output_type output_type_id value</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.01    135</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.025   137</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.05    139</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.1     140</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.15    141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.2     141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.25    142</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.3     143</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.35    144</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hub-bas… 2022-10-01  wk in…       1 US       quantile             0.4     145</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 128 more rows</span></span></span></code></pre></div>
<p>And connecting to cloud model output data follows the same procedure
described for fully configured cloud hubs:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_out_dir_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/s3_bucket.html">s3_bucket</a></span><span class="op">(</span></span>
<span>  <span class="st">"hubverse/hubutils/testhubs/simple/model-output/"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mod_out_con_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_model_output</a></span><span class="op">(</span></span>
<span>  <span class="va">mod_out_dir_cloud</span>,</span>
<span>  file_format <span class="op">=</span> <span class="st">"csv"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mod_out_con_cloud</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;mod_out_connection/FileSystemDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"csv(3/3)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">TRUE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"NULL"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir: <span style="color: #0000BB;">"hubverse/hubutils/testhubs/simple/model-output/"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; mod_out_connection with 3 csv files</span></span>
<span><span class="co">#&gt; 8 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int64</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: double</span></span>
<span><span class="co">#&gt; value: int64</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
<p>Like <code><a href="../reference/connect_hub.html">connect_hub()</a></code>, <code><a href="../reference/connect_hub.html">connect_model_output()</a></code>
has an optional <code>skip_checks</code> argument that improves
performance:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_out_dir_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/s3_bucket.html">s3_bucket</a></span><span class="op">(</span><span class="st">"hubverse/hubutils/testhubs/parquet/model-output/"</span><span class="op">)</span></span>
<span><span class="va">mod_out_con_cloud</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_model_output</a></span><span class="op">(</span><span class="va">mod_out_dir_cloud</span>, file_format <span class="op">=</span> <span class="st">"parquet"</span>, skip_checks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mod_out_con_cloud</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;mod_out_connection/FileSystemDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"parquet(4/4)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">FALSE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"NULL"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir: <span style="color: #0000BB;">"hubverse/hubutils/testhubs/parquet/model-output/"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; mod_out_connection with 4 Parquet files</span></span>
<span><span class="co">#&gt; 9 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int32</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: double</span></span>
<span><span class="co">#&gt; value: int32</span></span>
<span><span class="co">#&gt; age_group: string</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
<div class="section level3">
<h3 id="providing-a-custom-schema">Providing a custom schema<a class="anchor" aria-label="anchor" href="#providing-a-custom-schema"></a>
</h3>
<p>When connecting to a model output directly, you can also specify a
schema to override the default arrow schema auto-detection. This can
help at times to resolve conflicts in data types across different
dataset files.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'arrow'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     timestamp</span></span>
<span></span>
<span><span class="va">model_output_schema</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/schema.html" class="external-link">schema</a></span><span class="op">(</span></span>
<span>  origin_date <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">date32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  target <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  horizon <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">int32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  location <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  output_type <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  output_type_id <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">int32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  model_id <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_out_con</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_model_output</a></span><span class="op">(</span><span class="va">model_output_dir</span>,</span>
<span>  file_format <span class="op">=</span> <span class="st">"csv"</span>,</span>
<span>  schema <span class="op">=</span> <span class="va">model_output_schema</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mod_out_con</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB; font-weight: bold;">&lt;mod_out_connection/FileSystemDataset&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_format: <span style="color: #0000BB;">"csv(3/3)"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> checks: <span style="color: #0000BB;">TRUE</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> file_system: <span style="color: #0000BB;">"LocalFileSystem"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> model_output_dir:</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">"/home/runner/work/_temp/Library/hubUtils/testhubs/simple/model-output"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Connection schema</span></span>
<span><span class="co">#&gt; mod_out_connection with 3 csv files</span></span>
<span><span class="co">#&gt; 8 columns</span></span>
<span><span class="co">#&gt; origin_date: date32[day]</span></span>
<span><span class="co">#&gt; target: string</span></span>
<span><span class="co">#&gt; horizon: int32</span></span>
<span><span class="co">#&gt; location: string</span></span>
<span><span class="co">#&gt; output_type: string</span></span>
<span><span class="co">#&gt; output_type_id: string</span></span>
<span><span class="co">#&gt; value: int32</span></span>
<span><span class="co">#&gt; model_id: string</span></span></code></pre></div>
<p>Using a schema can however also produce new errors which can
sometimes be hard to debug. For example, here we are defining a schema
with field <code>output_type</code> cast as <code>int32</code> data
type. As column <code>output_type</code> actually contain character type
data which cannot be coerced to integer, connecting to the model output
directory produces an <code>arrow</code> error.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_output_schema</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/schema.html" class="external-link">schema</a></span><span class="op">(</span></span>
<span>  origin_date <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">date32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  target <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  horizon <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">int32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  location <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  output_type <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">int32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  output_type_id <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">int32</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  model_id <span class="op">=</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/data-type.html" class="external-link">string</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_out_con</span> <span class="op">&lt;-</span> <span class="fu">hubData</span><span class="fu">::</span><span class="fu"><a href="../reference/connect_hub.html">connect_model_output</a></span><span class="op">(</span><span class="va">model_output_dir</span>,</span>
<span>  file_format <span class="op">=</span> <span class="st">"csv"</span>,</span>
<span>  schema <span class="op">=</span> <span class="va">model_output_schema</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `arrow::open_dataset()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid: No non-null segments were available for field 'model_id'; couldn't infer type</span></span></code></pre></div>
<p>Beware that <code>arrow</code> errors can be somewhat misleading at
times so if you do get such a non-informative error, a good place to
start would be to check your schema matches the columns and your data
can be coerced to the data types specified in the schema.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anna Krystalli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1. PR Previews built by <a href="https://www.netlify.com" class="external-link">Netlify</a>. Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>





  </body>
</html>
